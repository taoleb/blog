---
layout: post
title:  "地平线&港大最新端到端进展！HE-Drive：VLM+扩散模型发大力"
author: sal
categories: [ Jekyll, tutorial ]
image: assets/images/15.jpg
---
这篇论文提出了 HE-Drive，一个全新的以人类驾驶行为为中心的端到端自动驾驶系统。

HE-Drive 的目标是生成时间一致性强且舒适的驾驶轨迹，解决了现有模仿学习方法在轨迹规划中存在的时间不一致和不舒适问题。
![本文目录]({{ site.baseurl }}//assets/images/15-1.jpg)
核心思想
HE-Drive 的核心思想是将稀疏感知、基于扩散的运动规划和视觉语言模型引导的轨迹评分器相结合，模拟人类驾驶员的决策过程。

关键创新
基于扩散的运动规划器: 利用条件去噪扩散概率模型 (DDPM) 生成具有强时间一致性的多模态轨迹，克服了传统模仿学习方法对时间相关性建模不足的缺陷。

即插即用轨迹评分器: 结合规则评分器和视觉语言模型 (VLMs, 如 Llama 3.2V) 的优势，实现了对轨迹舒适度的评估和驾驶风格的调整，提升了驾驶体验和泛化能力。

端到端驾驶舒适度指标: 提出了一个通用的舒适度指标，用于评估预测轨迹与真实轨迹的相似性，考虑了动态可行性、加速度和轨迹平滑度等因素。

算法流程
HE-Drive 的算法流程可以分为以下四个阶段：

稀疏感知: 利用视觉编码器从多视角摄像头图像中提取特征，然后通过稀疏感知模块 (如 SparseDrive 中的方法) 进行目标检测、跟踪和在线建图，生成紧凑的 3D 场景表示。

基于扩散的运动规划: 将 3D 场景表示、车辆自身状态、历史预测轨迹及其对应的速度、加速度和航向角编码作为条件输入到 DDPM 模型中，生成具有强时间一致性的多模态未来轨迹。

VLMs 引导的轨迹评分: 使用预先定义的规则评分函数对生成的轨迹进行初步评分，然后利用视觉语言模型 (VLMs) 对场景和驾驶风格进行分析，并调整规则评分函数中的权重，最终选择最舒适的轨迹。

车辆控制: 将评分最高的轨迹作为控制车辆的依据，实现端到端的自动驾驶。

举例说明：

假设车辆行驶到一个十字路口，DDPM 模型会生成多条可能的轨迹，例如左转、直行和右转。规则评分函数会根据碰撞风险、车道偏离等因素对这些轨迹进行初步评分。然后，VLMs 会分析场景，例如识别交通信号灯状态、行人过道情况等，并根据驾驶风格 (激进或保守) 调整规则评分函数中的权重，例如在保守模式下增加对碰撞风险的惩罚权重。最终，评分最高的轨迹 (例如在绿灯情况下直行) 会被选择并用于控制车辆。

实验结果
在 nuScenes 和 OpenScene 数据集上的实验结果表明，HE-Drive 在开环和闭环测试中均取得了最先进的性能。HE-Drive 不仅显著降低了平均碰撞率 (比 VAD 降低 71%) 和 L2 误差，而且提高了效率 (比 SparseDrive 快 1.9 倍)，同时在真实世界数据上实现了 32% 的舒适度提升。

贡献
首次提出了一个以人类驾驶行为为中心的端到端自动驾驶系统，能够生成时间一致性强且舒适的驾驶轨迹。

提出了基于扩散的运动规划器和 VLMs 引导的轨迹评分器，有效解决了现有方法的局限性。

提出了端到端驾驶舒适度指标，为评估自动驾驶系统的舒适性提供了新的方法。

局限性
VLMs 的可靠性: VLMs 的推理结果可能存在幻觉或偏差，需要进一步研究如何提高其在自动驾驶场景下的可靠性。

计算成本: VLMs 的计算成本较高，可能会影响系统的实时性能。

应用展望
HE-Drive 为构建更加安全、高效和舒适的自动驾驶系统提供了新的思路，未来可以进一步研究以下方向：

探索更加高效的 VLMs 模型，降低计算成本并提高实时性能。

研究如何将人类驾驶员的经验和知识更好地融入到自动驾驶系统中。

开发更加全面的端到端驾驶舒适度指标，涵盖更多影响驾驶体验的因素。

总而言之，HE-Drive 是一项具有重要意义的研究工作，为自动驾驶技术的发展提供了新的方向。相信随着技术的不断进步，HE-Drive 将会得到进一步完善和应用，最终实现更加安全、舒适和智能的自动驾驶体验。