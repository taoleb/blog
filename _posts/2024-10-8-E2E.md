---
layout: post
title: "个人博客<br>端到端自动驾驶新语"
author: taoleb
categories: [ Jekyll, tutorial ]
image: assets/images/home.jpg
tags: [sticky]
---
## 端到端发展现状

10月10日，特斯拉将于推出备受期待的Robotaxi。特斯拉CEO埃隆·马斯克(Elon Musk)在多次场合暗示，该公司的出租车可以随时随地自主驾驶，因为它不依赖预先绘制的数据来做出决定，而是使用一种智能的摄像头系统，能够智能地评估情况并实时做出决定。

而9月24日公布的一份评测报告给FSD泼了一盆冷水，该报告显示，FSD在测试中平均13英里（约21公里）就要人为干预1次。

这可能是独立第三方对特斯拉的FSD进行的最广泛的真实世界测试，AMCI Testing认为，特斯拉必须需要很长时间才能安全进行Robotaxi操作。

AMCI测试，采用了一辆配备了Hardware 4并运行FSD最新软件版本（12.5.1和12.5.3）的2024款特斯拉Model 3 Performance。测试里程超过1000英里（约1610公里），驾驶环境包括城市街道、农村双车道公路、山路和高速公路。测试时间包括白天和夜晚，光线环境从背光到全正面阳光。

## 主流的学术界/工业界解决方案

这 20 家玩家的端到端自动驾驶方案可以分为四个类别：主机厂、方案商、芯片/模型商和实验室。

**主机厂**

●**特斯拉**：从 FSD v12 开始全面进入“端到端”架构，最新版本 FSD 12.5 已在美国市场上市，参数量是 V12.4 的五倍，可以实现高速和一般道路的算法统一**1**。特斯拉的“端到端”模型架构尚未公布，但有推测表示，特斯拉端到端有可能采用生成式 AI 模型**1**。

●**理想**：与清华大学 MARS-LAB 合作提出了 DriveVLM 端到端大模型，采用“端到端模型 + 大视觉模型（VLM）”架构**23**。DriveVLM-Dual 模型分为两个系统：系统 1 是端到端模型，系统 2 是基于视觉语言模型（VLM）实现的 DriveVLM**3**。

●**小鹏**：已 All In 端到端，其端到端技术方案由感知大模型 XNet、规控大模型 XPlanner、大语言模型 XBrain 三个组成部分构成**4**。

●**蔚来**：采用“Two Model”端到端方案，感知模型采用融合化的感知网络，规控模型采用数据驱动的分层价值网络**5**。

●**奔驰**：采用端到端大模型，实现全场景高阶智能驾驶，不依赖高精地图**6**。奔驰与图宾根大学、埃斯林根应用科学大学，共同提出了 DualAD 端到端架构，该架构是一个基于 Transformer 的模块化框架**6**。

●**零一汽车**：采用端到端架构，其中 LLM 使用的是 META 开源大模型（Llama7B 版本）**7**。

**方案商**

●**商汤绝影**：提出了行业首个感知决策一体化自动驾驶通用模型 UniAD，并推出了多模态大模型 DriveAGI**89**。

●**华为**：发布了 ADS3.0，决策规划部分采用 PDP（Prediction-Decision-Planning，预测决策规控）网络**9**。

●**百度**：发布了支持 L4 级自动驾驶的大模型 Apollo ADFM**9**。

●**鉴智机器人**：原创的自动驾驶端到端模型 GraphAD，已经可以量产部署**10**。

●**元戎启行**：基于 DeepRoute-IO 的端到端解决方案，采用 Orin-X，配备 1 颗固态激光雷达，11 颗摄像头**11**。

●**Momenta**：将在 2025 年前完成端到端规划和完全端到端自动驾驶，并行采用了“One Model”和“Two Model”两个支路**12**。

●**comma.ai**：推出了开源的端到端自动驾驶产品 OpenPilot，其核心是 Supercombo 端到端神经网络模型**1314**。

**芯片/模型商**

●**地平线**：发布了多个研究成果，包括：感知端到端算法 Sparse4D，基于矢量化场景表征的端到端自动驾驶算法 VAD，端到端矢量地图在线构建方法 MapTR 等，并且这些技术目前均已开源**14**。

●**英伟达**：提出了 Hydra-MDP 端到端模型，并计划在 L2++ 系统上实现端到端的自动驾驶**1516**。

●

**Wavye**：推出了大型语言模型 LINGO-1/2，视觉生成模型 GAIA-1，以及专为高级自动驾驶仿真训练和测试而设计的 PRISM-1**17**。

●**极佳科技**：推出了全球首个物理世界驱动的自动驾驶世界模型 DriveDreamer，以及具身智能视觉数据引擎 Giga Studio 和数字孪生闭环模拟器 Giga World**181920**。

●**光轮智能**：开发了自研的端到端数据与仿真的全链路解决方案，并开源了自动驾驶 3D Occupancy 合成数据集 "LightwheelOcc"**20**。

**实验室**

●**上海AI Lab**：开源了 BEVFormer 架构，与武汉大学、商汤科技联合提出了端到端自动驾驶算法 UniAD，并推出了利用大语言模型进行闭环端到端自动驾驶的工作 LMDrive、自动驾驶视频生成模型 GenAD 等**21**。

●**清华大学MARS Lab**：研究如何让机器像人一样的能够通过多种感知输入进行学习、推理和交互，研究涵盖了多模态学习的基础问题及其应用**22**。

**总结**

●目前“端到端”架构主要以“Two Model”方案为主，未来将逐渐过渡到“One Model”**22**。

●LLM 或 VLM 等大模型具备理解复杂环境的能力，通常作为可以深度思考的“慢系统”**22**。

●目前各种端到端模型的下限比较低，在实际量产落地中，必须有安全兜底模块保证车辆安全**22**

## 端到端面临的挑战及解决思路

**1. 数据依赖性与泛化能力**

- **挑战:** 端到端系统高度依赖训练数据，需要海量高质量数据覆盖各种驾驶场景和路况。然而，获取和标注真实驾驶数据成本高昂，且难以覆盖所有可能情况。此外，训练数据与实际路况的差异会导致系统泛化能力不足，难以应对新的或未见过的场景。
- **解决方案:**
    - **数据增强:** 利用数据增强技术，例如旋转、平移、缩放、添加噪声等，从现有数据中生成更多样化的训练样本，提升模型的泛化能力。
    - **仿真环境:** 利用高保真仿真环境，例如 CARLA、SUMO 等，生成大量逼真的驾驶场景和数据，弥补真实数据的不足。
    - **领域自适应:** 运用领域自适应技术，例如对抗训练、迁移学习等，将模型从训练数据集迁移到目标数据集，提升模型在目标领域的表现。
    - **持续学习:** 开发能够持续学习的端到端系统，使其能够不断学习新的驾驶场景和知识，并适应不断变化的环境。

**2. 可解释性与安全性**

- **挑战:** 端到端系统通常被视为“黑匣子”，难以理解其内部决策过程和逻辑，导致难以调试和验证系统的安全性。缺乏可解释性也阻碍了公众对自动驾驶技术的信任。
- **解决方案:**
    - **可解释性AI:** 研究和应用可解释性AI技术，例如注意力机制、特征可视化、规则提取等，揭示端到端系统内部的决策机制，增强系统的透明度和可信度。
    - **形式化验证:** 利用形式化方法，例如模型检验、定理证明等，对端到端系统的安全性进行严格的数学验证，确保系统在各种情况下都能做出安全的决策。
    - **安全测试与评估:** 建立完善的安全测试和评估体系，包括仿真测试、封闭场地测试、公开道路测试等，对端到端系统进行全面的安全评估，确保系统在实际应用中的安全性。

**3. 多传感器融合**

- **挑战:** 自动驾驶汽车通常配备多种传感器，例如摄像头、激光雷达、毫米波雷达等，每种传感器提供的信息类型和视角都不同。如何有效地融合多传感器数据，提取关键信息，并进行联合优化，是端到端系统面临的挑战之一。
- **解决方案:**
    - **多模态学习:** 研究和应用多模态学习技术，例如深度融合网络、注意力机制等，有效地融合不同模态的传感器数据，并学习跨模态的特征表示。
    - **统一的感知表示:** 将不同传感器数据映射到统一的感知表示空间，例如鸟瞰图（BEV）或三维语义地图，方便后续模块进行处理和决策。
    - **传感器冗余与互补:** 利用传感器冗余和互补性，例如摄像头和激光雷达的融合，提高系统的鲁棒性和可靠性。

**4. 世界模型学习**

- **挑战:** 构建准确可靠的世界模型是端到端系统进行规划和决策的关键。世界模型需要能够预测环境的未来状态，以及自身行为对环境的影响。然而，驾驶环境高度复杂且动态，构建精确的世界模型非常困难。
- **解决方案:**
    - **基于模型的强化学习:** 利用基于模型的强化学习方法，例如 Dreamer、MuZero 等，学习世界模型并利用其进行规划和决策，提高样本效率和泛化能力。
    - **概率模型:** 使用概率模型，例如高斯过程、贝叶斯网络等，对环境的不确定性进行建模，提高世界模型的预测精度和鲁棒性。
    - **多层次世界模型:** 构建多层次的世界模型，例如将环境分解为静态地图、动态物体、交通规则等多个层次，分别进行建模，降低建模的难度。

**5. 因果混乱**

- **挑战:** 端到端系统容易受到因果混乱的影响，即系统可能会学习到输入和输出之间虚假的相关性，而不是真正的因果关系。例如，系统可能会学习到“看到刹车灯亮就刹车”，而不是“因为前方车辆减速所以刹车”。因果混乱会导致系统做出错误的决策，尤其是在遇到新的或未见过的场景时。
- **解决方案:**
    - **因果推理:** 研究和应用因果推理技术，例如因果图、结构方程模型等，识别输入和输出之间的真正因果关系，避免系统学习到虚假的相关性。
    - **干预学习:** 利用干预学习方法，例如反事实推理等，评估不同行为对环境的影响，并学习更稳健的因果关系。
    - **数据多样性:** 增加训练数据的
        
        多样性，覆盖各种驾驶场景和路况，减少数据偏差对系统的影响。
        

**6. 计算资源与实时性**

- **挑战:** 端到端系统通常需要大量的计算资源进行训练和推理，这给车载计算平台带来了挑战。此外，自动驾驶系统需要实时做出决策，以确保行车安全，因此端到端系统的推理速度需要满足实时性要求。
- **解决方案:**
    - **模型压缩:** 利用模型压缩技术，例如剪枝、量化、知识蒸馏等，减少模型的计算量和内存占用，提高推理速度。
    - **硬件加速:** 利用专用硬件，例如 GPU、FPGA 等，加速端到端系统的训练和推理。
    - **分布式计算:** 利用分布式计算平台，例如云计算、边缘计算等，将端到端系统的训练和推理任务分布到多个计算节点上，提高计算效率。

**7. 策略蒸馏**

- **挑战:** 策略蒸馏是一种常用的端到端训练方法，它利用一个已训练好的“教师”模型来指导“学生”模型的学习。然而，如何选择合适的教师模型，以及如何有效地将知识从教师模型传递到学生模型，是策略蒸馏面临的挑战。
- **解决方案:**
    - **多教师蒸馏:** 利用多个教师模型来指导学生模型的学习，例如将不同传感器模态的教师模型融合起来，或将不同驾驶风格的教师模型融合起来。
    - **特征蒸馏:** 除了输出蒸馏外，还可以进行特征蒸馏，即将教师模型的中间层特征作为学生模型的学习目标，帮助学生模型学习更丰富的特征表示。
    - **强化学习蒸馏:** 利用强化学习方法来进行策略蒸馏，例如将教师模型的策略作为奖励函数，引导学生模型学习更优的策略。

## **端到端自动驾驶未来发展的方向**

**1. 数据引擎与数据闭环**

- **挑战:** 端到端系统高度依赖数据，需要海量、高质量、多样化的数据进行训练和验证。如何高效地收集、处理、管理和利用数据，是端到端系统发展面临的关键挑战之一。
- **发展方向:**
    - **构建大规模自动驾驶数据集:** 通过车队采集、众包标注、仿真生成等方式，构建覆盖各种驾驶场景、路况、天气条件的大规模自动驾驶数据集，为端到端系统的训练提供充足的数据支撑。
    - **开发高效的数据处理和标注工具:** 利用人工智能、机器学习等技术，开发自动化或半自动化的数据处理和标注工具，降低数据处理成本，提高数据标注效率。
    - **建立数据闭环系统:** 将数据采集、模型训练、性能评估、策略更新等环节形成闭环，实现数据的持续迭代和模型的持续优化，不断提升端到端系统的性能。

**2. 大型基础模型与多模态学习**

- **挑战:** 端到端系统需要处理复杂的感知信息和驾驶决策，需要强大的模型架构和学习能力。如何构建更强大的模型，并使其能够处理多模态数据，是端到端系统发展面临的另一个挑战。
- **发展方向:**
    - **利用大型预训练模型:** 例如 Transformer、BERT 等，作为端到端系统的基础架构，利用其强大的特征提取和学习能力，提升端到端系统的性能。
    - **发展多模态学习技术:** 例如深度融合网络、注意力机制等，使端到端系统能够有效地融合来自摄像头、激光雷达、毫米波雷达等多种传感器的感知信息，并进行联合优化。
    - **探索跨模态知识迁移:** 将不同模态数据之间的知识进行迁移，例如将图像识别模型的知识迁移到激光雷达点云识别模型，提升模型的泛化能力。

**3. 车辆V2X协同驾驶**

- **挑战:** 端到端系统需要感知和理解周围环境，并做出安全的驾驶决策。然而，自动驾驶汽车的感知范围有限，难以获取全局信息。如何利用车辆到一切（V2X）技术，例如车路协同、车车协同等，扩展自动驾驶汽车的感知范围，提高驾驶安全性，是端到端系统发展面临的又一挑战。
- **发展方向:**
    - **融合 V2X 信息:** 将来自路侧基础设施、其他车辆、行人等的信息融合到端到端系统中，例如交通信号灯状态、道路拥堵情况、行人轨迹等，扩展自动驾驶汽车的感知范围，提高驾驶安全性。
    - **开发协同驾驶策略:** 利用 V2X 技术，实现车辆之间的协同驾驶，例如编队行驶、协同换道、协同避障等，提高交通效率和安全性。
    - **构建车路云协同系统:** 将车辆、路侧基础设施、云端服务器等连接起来，形成车路云协同系统，实现数据的共享和计算资源的协同，提升自动驾驶系统的整体性能。

**4. 可解释性AI与安全验证**

- **挑战:** 端到端系统通常被视为“黑匣子”，难以理解其内部决策过程和逻辑，导致难以调试和验证系统的安全性。如何提高端到端系统的可解释性，并对其安全性进行验证，是端到端系统发展面临的重要挑战。
- **发展方向:**
    - **发展可解释性AI技术:** 例如注意力机制、特征可视化、规则提取等，揭示端到端系统内部的决策机制，增强系统的透明度和可信度。
    - **利用形式化方法进行安全验证:** 例如模型检验、定理证明等，对端到端系统的安全性进行严格的数学验证，确保系统在各种情况下都能做出安全的决策。
    - **建立完善的安全测试和评估体系:** 包括仿真测试、封闭场地测试、公开道路测试等，对端到端系统进行全面的安全评估，确保系统在实际应用中的安全性。

**5. 模拟仿真与虚拟测试**

- **挑战:** 自动驾驶系统的测试和验证需要大量的道路测试，成本高昂且存在安全风险。如何利用模拟仿真技术，构建虚拟测试环境，降低测试成本，提高测试效率，是端到端系统发展面临的另一个挑战。
- **发展方向:**
    - **开发高保真仿真环境:** 例如 CARLA、SUMO 等，模拟各种驾驶场景、路况、天气条件，并生成逼真的传感器数据，为端到端系统的测试和验证提供虚拟测试环境。
    - **构建场景库:** 收集和构建各种驾驶场景，例如交通事故场景、极端天气场景等，用于测试和评估端到端系统的性能和安全性。
    - **发展虚拟测试技术:** 例如基于仿真的测试、基于模型的测试等，在虚拟环境中对端到端系统进行测试和验证，降低测试成本，提高测试效率。
## 结语

端到端自动驾驶技术正处于快速发展阶段，尽管面临诸多挑战，但其潜力不可忽视。从数据依赖性到多传感器融合，从可解释性到安全性，各个领域的研究者和企业都在积极探索解决方案。未来，随着数据引擎的完善、大型基础模型的应用以及V2X协同驾驶的推进，端到端自动驾驶有望实现更高的安全性和效率。

然而，技术的进步不仅仅依赖于算法和硬件的提升，更需要在法规、伦理和社会接受度等方面的支持。我们期待在不久的将来，端到端自动驾驶能够真正走入大众生活，为人们带来更安全、更便捷的出行体验。

感谢您阅读本篇博客，希望本文能为您提供有价值的见解和启发。如果您有任何问题或建议，欢迎在评论区留言讨论。